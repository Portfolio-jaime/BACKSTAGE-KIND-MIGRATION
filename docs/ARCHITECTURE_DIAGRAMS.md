# ğŸ—ï¸ Backstage Architecture - Complete Diagrams

## ğŸ“‹ Contents

- [Component Architecture](#-component-architecture)
- [Network Flow](#-network-flow)
- [Data Flow](#-data-flow)
- [Deployment Pipeline](#-deployment-pipeline)
- [Security Architecture](#-security-architecture)

---

## ğŸ›ï¸ Component Architecture

### Complete System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ğŸŒ Production Environment                             â”‚
â”‚                                                                               â”‚
â”‚  External Users                                                               â”‚
â”‚  ğŸ‘¤ğŸ‘¤ğŸ‘¤ â”€â”€â–¶ https://backstage.arhean.com                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚ HTTPS/TLS 1.2+
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ”’ Security Layer                                     â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ›¡ï¸  Ingress Controller (nginx-ingress)                                â”‚  â”‚
â”‚  â”‚                                                                         â”‚  â”‚
â”‚  â”‚  â€¢ TLS Termination (Let's Encrypt)                                     â”‚  â”‚
â”‚  â”‚  â€¢ Certificate Auto-renewal                                            â”‚  â”‚
â”‚  â”‚  â€¢ SSL/TLS v1.2, v1.3 only                                             â”‚  â”‚
â”‚  â”‚  â€¢ HTTP â†’ HTTPS redirect                                               â”‚  â”‚
â”‚  â”‚  â€¢ Rate limiting                                                        â”‚  â”‚
â”‚  â”‚  â€¢ DDoS protection                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ HTTP (Internal)
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      â˜¸ï¸  Kubernetes Cluster (Kind)                           â”‚
â”‚                                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚             ğŸ“¦ Namespace: backstage                                  â”‚    â”‚
â”‚  â”‚                                                                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ”µ Service: backstage                                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Type: ClusterIP                                             â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Port: 80 â†’ 7007                                             â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Session Affinity: ClientIP (3h timeout)                     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Selector: app=backstage                                     â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                           â”‚                                         â”‚    â”‚
â”‚  â”‚                           â”‚ Load Balancing                          â”‚    â”‚
â”‚  â”‚                           â–¼                                         â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ“Š Deployment: backstage                                     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Strategy: RollingUpdate                                     â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”œâ”€ maxUnavailable: 1                                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€ maxSurge: 1                                              â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Current Replicas: 1                                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Desired Replicas: 1                                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Pod: backstage-76b7ff7c68-gtf48                    â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                                       â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Labels:                                              â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ app: backstage                                     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ component: backend                                 â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ pod-template-hash: 76b7ff7c68                      â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                                       â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  Annotations:                                         â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ prometheus.io/scrape: "true"                       â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ prometheus.io/port: "7007"                         â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ prometheus.io/path: "/metrics"                     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                                       â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  ğŸ”§ Init Container: wait-for-postgres        â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Image: busybox:1.36                         â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Command:                                    â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚    while ! nc -z postgres 5432; do           â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚      sleep 2                                 â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚    done                                      â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Resources:                                  â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚    requests: { cpu: 50m, memory: 64Mi }     â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚    limits: { cpu: 100m, memory: 128Mi }     â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                                       â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  ğŸ­ Main Container: backstage                â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Image: jaimehenao8126/backstage-           â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚         production:v7                        â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Pull Policy: Always                         â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Port: 7007/TCP (http)                       â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  ğŸ“¦ Application Stack                â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚                                      â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  Node.js 20 LTS                      â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ Express.js (Backend API)         â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ React 18 (Frontend SPA)          â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â”œâ”€ TypeScript 5.8                   â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€ Backstage Plugins:               â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚     â€¢ @backstage/plugin-catalog      â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚     â€¢ @backstage/plugin-kubernetes   â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚     â€¢ @backstage/plugin-techdocs     â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚     â€¢ @roadiehq/plugin-argo-cd       â”‚   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Environment Variables:                      â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ NODE_ENV=production                       â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ NODE_OPTIONS=--max-old-space-size=1024    â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ From ConfigMap: backstage-env-config      â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ From Secret: backstage-secrets            â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Resources:                                  â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚    requests:                                 â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚      cpu: 250m (0.25 cores)                  â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚      memory: 512Mi                           â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚    limits:                                   â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚      cpu: 1000m (1 core)                     â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚      memory: 2Gi                             â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Volume Mounts:                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ /tmp (emptyDir, 1Gi)                      â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ /app/tmp (emptyDir, 1Gi)                  â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Health Checks:                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  âœ… Startup:  /healthcheck (max 2min)        â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  âœ… Liveness: /healthcheck (every 30s)       â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  âœ… Readiness: /healthcheck (every 10s)      â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                              â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Security Context:                           â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ runAsNonRoot: true                        â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ runAsUser: 1000                           â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ allowPrivilegeEscalation: false           â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ capabilities: drop ALL                    â”‚   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ—„ï¸  StatefulSet: psql-postgresql                            â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Replicas: 1                                                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Pod Management Policy: OrderedReady                         â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   Pod: psql-postgresql-0                            â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚                                                       â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  ğŸ˜ PostgreSQL 14                          â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                            â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Port: 5432/TCP                            â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Database: backstage_plugin_catalog        â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                            â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Volume:                                   â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ PVC: data-psql-postgresql-0             â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Size: 8Gi                               â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ StorageClass: standard (or hostpath)    â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Mount: /var/lib/postgresql/data         â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                            â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  Connections:                              â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Max connections: 100                    â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Shared buffers: 256MB                   â”‚     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ“‹ ConfigMap: backstage-env-config                           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Data (12 entries):                                           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ NODE_ENV: production                                       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POSTGRES_HOST: psql-postgresql.backstage.svc.cluster.localâ”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POSTGRES_PORT: 5432                                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POSTGRES_DB: backstage_plugin_catalog                      â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ BACKEND_URL: https://backstage.arhean.com                  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ ... (more environment variables)                           â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ” Secret: backstage-secrets                                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Data (5 entries, base64 encoded):                            â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POSTGRES_USER: *****                                       â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ POSTGRES_PASSWORD: *****                                   â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GITHUB_TOKEN: ghp_*****                                    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GITHUB_CLIENT_ID: *****                                    â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ GITHUB_CLIENT_SECRET: *****                                â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ”‘ ServiceAccount: backstage                                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  ClusterRole: backstage-backend                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  ClusterRoleBinding: backstage-backend                        â”‚  â”‚    â”‚
â”‚  â”‚  â”‚                                                               â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  Permissions:                                                 â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ apiGroups: ["*"]                                           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ resources: ["*"]                                           â”‚  â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ verbs: ["get", "list", "watch"]                            â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ Network Flow

### Request Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Complete Request Flow                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: External Request
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¤ User  â”‚  GET https://backstage.arhean.com/catalog
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
      â”‚
      â”‚ â‘  DNS Resolution
      â–¼
   DNS Server
      â”‚
      â”‚ â‘¡ Resolves to: 192.168.1.100
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Load Balancer â”‚  (or Ingress IP)
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ â‘¢ HTTPS/443 (TLS encrypted)
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ingress Controller (nginx)                                      â”‚
â”‚                                                                   â”‚
â”‚  â‘£ TLS Termination:                                              â”‚
â”‚     â€¢ Validates client certificate (if mTLS)                     â”‚
â”‚     â€¢ Decrypts HTTPS â†’ HTTP                                      â”‚
â”‚     â€¢ Checks Host header: backstage.arhean.com                   â”‚
â”‚     â€¢ Applies rate limiting                                      â”‚
â”‚     â€¢ Logs request                                               â”‚
â”‚                                                                   â”‚
â”‚  â‘¤ Route Selection:                                              â”‚
â”‚     â€¢ Path: /catalog                                             â”‚
â”‚     â€¢ Backend: backstage-service:80                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ â‘¥ HTTP/80 (Internal network)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Service: backstage (ClusterIP)                                  â”‚
â”‚                                                                   â”‚
â”‚  â‘¦ Load Balancing:                                               â”‚
â”‚     â€¢ Type: ClusterIP (10.96.123.45:80)                          â”‚
â”‚     â€¢ Session Affinity: ClientIP                                 â”‚
â”‚     â€¢ Selects Pod based on IP hash                               â”‚
â”‚     â€¢ Target: backstage-76b7ff7c68-gtf48:7007                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ â‘§ HTTP/7007 (Pod network)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod: backstage-76b7ff7c68-gtf48                                 â”‚
â”‚                                                                   â”‚
â”‚  â‘¨ Container receives request:                                   â”‚
â”‚     â€¢ Port: 7007                                                 â”‚
â”‚     â€¢ Process: Node.js (PID 1)                                   â”‚
â”‚     â€¢ Handler: Express.js router                                 â”‚
â”‚                                                                   â”‚
â”‚  â‘© Application Processing:                                       â”‚
â”‚                                                                   â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚     â”‚  Express Router  â”‚                                         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚              â”‚                                                    â”‚
â”‚              â”œâ”€â–¶ Auth Middleware (check JWT/session)             â”‚
â”‚              â”œâ”€â–¶ CORS Middleware                                 â”‚
â”‚              â”œâ”€â–¶ Logging Middleware                              â”‚
â”‚              â”‚                                                    â”‚
â”‚              â–¼                                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚     â”‚ Catalog Plugin   â”‚                                         â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚              â”‚                                                    â”‚
â”‚              â”‚ â‘ª Database Query                                  â”‚
â”‚              â–¼                                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚     â”‚  PostgreSQL Client                   â”‚                     â”‚
â”‚     â”‚  SELECT * FROM catalog_entities      â”‚                     â”‚
â”‚     â”‚  WHERE kind = 'Component'            â”‚                     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â”‚ â‘« PostgreSQL Protocol (port 5432)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod: psql-postgresql-0                                          â”‚
â”‚                                                                   â”‚
â”‚  â‘¬ Database Query Execution:                                     â”‚
â”‚     â€¢ Receives query                                             â”‚
â”‚     â€¢ Parses SQL                                                 â”‚
â”‚     â€¢ Executes query plan                                        â”‚
â”‚     â€¢ Fetches from disk/cache                                    â”‚
â”‚     â€¢ Returns result set                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ â‘­ Result (rows)
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backstage Pod - Response Processing                             â”‚
â”‚                                                                   â”‚
â”‚  â‘® Transform Data:                                               â”‚
â”‚     â€¢ Convert DB rows â†’ JSON                                     â”‚
â”‚     â€¢ Apply business logic                                       â”‚
â”‚     â€¢ Add metadata                                               â”‚
â”‚     â€¢ Format response                                            â”‚
â”‚                                                                   â”‚
â”‚  â‘¯ Send Response:                                                â”‚
â”‚     HTTP/1.1 200 OK                                              â”‚
â”‚     Content-Type: application/json                               â”‚
â”‚     {                                                            â”‚
â”‚       "items": [...],                                            â”‚
â”‚       "totalCount": 42                                           â”‚
â”‚     }                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ â‘° Response flows back
                            â–¼
       Service â”€â–¶ Ingress â”€â–¶ Load Balancer â”€â–¶ Internet â”€â–¶ User

Total Latency Breakdown:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DNS Resolution:          ~10-50ms     â”‚
â”‚  TLS Handshake:           ~50-100ms    â”‚
â”‚  Ingress Routing:         ~5-10ms      â”‚
â”‚  Service Load Balance:    ~1-5ms       â”‚
â”‚  App Processing:          ~50-200ms    â”‚
â”‚  Database Query:          ~10-100ms    â”‚
â”‚  Response Assembly:       ~10-50ms     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚  Total (typical):         ~150-500ms   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Network Policies (if enabled)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Network Segmentation                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ingress       â”‚       â”‚  Other          â”‚
â”‚   Controller    â”‚       â”‚  Namespaces     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                         â”‚
         â”‚ âœ… Allowed              â”‚ âŒ Denied
         â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   backstage namespace              â”‚
    â”‚                                    â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    â”‚  â”‚Backstage â”‚â”€â”€â”€â”€â–¶â”‚PostgreSQLâ”‚   â”‚
    â”‚  â”‚  Pod     â”‚     â”‚   Pod    â”‚   â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    â”‚       â”‚                â”‚          â”‚
    â”‚       â”‚ âœ… Port 5432   â”‚          â”‚
    â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
    â”‚                                    â”‚
    â”‚  Internet egress: âœ… Allowed      â”‚
    â”‚  (for GitHub API, etc.)           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow

### Application Data Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Backstage Data Flow Architecture                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

External Sources                Backstage                  Storage
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   GitHub     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Catalog         â”‚
â”‚   API        â”‚               â”‚  Processor       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚ â‘  Discover
â”‚   GitLab     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶         â”‚    Repositories
â”‚   API        â”‚                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Kubernetes  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Entity          â”‚
â”‚  API         â”‚               â”‚  Providers       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ â‘¡ Parse
                                        â”‚    catalog-info.yaml
                                        â”‚
                                        â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  Entity          â”‚â”€â”€â”€â”€â”€â–¶â”‚ PostgreSQL  â”‚
                               â”‚  Transformer     â”‚      â”‚             â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  Tables:    â”‚
                                        â”‚                â”‚  â€¢ entities â”‚
                                        â”‚                â”‚  â€¢ relationsâ”‚
                                        â”‚ â‘¢ Transform    â”‚  â€¢ metadata â”‚
                                        â”‚    & Validate  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  Database        â”‚
                               â”‚  Writer          â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ â‘£ Store
                                        â”‚    Entities
                                        â”‚
                                        â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  PostgreSQL Database                  â”‚
                               â”‚                                      â”‚
                               â”‚  backstage_plugin_catalog            â”‚
                               â”‚  â”œâ”€ entities (10K+ rows)             â”‚
                               â”‚  â”‚   â€¢ uid, name, kind, namespace    â”‚
                               â”‚  â”‚   â€¢ metadata (JSON)               â”‚
                               â”‚  â”‚   â€¢ spec (JSON)                   â”‚
                               â”‚  â”‚                                   â”‚
                               â”‚  â”œâ”€ relations (50K+ rows)            â”‚
                               â”‚  â”‚   â€¢ source_entity_ref             â”‚
                               â”‚  â”‚   â€¢ target_entity_ref             â”‚
                               â”‚  â”‚   â€¢ type (ownedBy, partOf, etc.)  â”‚
                               â”‚  â”‚                                   â”‚
                               â”‚  â””â”€ refresh_state                    â”‚
                               â”‚      â€¢ entity_id                     â”‚
                               â”‚      â€¢ last_discovery                â”‚
                               â”‚      â€¢ next_update                   â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â–²
                                        â”‚
                                        â”‚ â‘¤ Read
                                        â”‚    Queries
                                        â”‚
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  Catalog API     â”‚
                               â”‚  Endpoints       â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ â‘¥ Serve
                                        â”‚    to UI
                                        â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚  React Frontend  â”‚
                               â”‚                  â”‚
                               â”‚  Components:     â”‚
                               â”‚  â€¢ EntityPage    â”‚
                               â”‚  â€¢ CatalogTable  â”‚
                               â”‚  â€¢ EntityGraph   â”‚
                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â”‚ â‘¦ Render
                                        â”‚    to User
                                        â–¼
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚ ğŸ‘¤ User â”‚
                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Plugin Data Flow Example

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Kubernetes Plugin - Pod Information Flow                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User Action                  Frontend              Backend            K8s
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€           â”€â”€â”€â”€â”€

ğŸ‘¤ Clicks                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
"View Pods" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ React    â”‚
                             â”‚ Componentâ”‚
                             â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘  API Call
                                   â”‚ GET /api/kubernetes/pods
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Backend API â”‚
                            â”‚  Router      â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘¡ Auth Check
                                   â”‚ (JWT validation)
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Kubernetes  â”‚
                            â”‚  Plugin      â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘¢ Identify
                                   â”‚    Cluster
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Cluster     â”‚
                            â”‚  Supplier    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘£ Get
                                   â”‚    Credentials
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  ServiceAccount  â”‚
                            â”‚  Token           â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘¤ API Request
                                   â”‚ GET /api/v1/pods
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Kubernetes API Server â”‚
                            â”‚  (in-cluster)          â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘¥ RBAC Check
                                   â”‚ (can list pods?)
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Pod List      â”‚
                            â”‚  Response      â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘¦ Transform
                                   â”‚    to JSON
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Backstage     â”‚
                            â”‚  Plugin        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘§ Return
                                   â”‚    Response
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  React         â”‚
                            â”‚  Component     â”‚
                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â”‚ â‘¨ Render
                                   â”‚    Table
                                   â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚  Pod Table     â”‚
                            â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                            â”‚  â”‚Name Statusâ”‚ â”‚
                            â”‚  â”‚app  Ready â”‚ â”‚
                            â”‚  â”‚db   Ready â”‚ â”‚
                            â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Continue to Security Architecture in next section...**
